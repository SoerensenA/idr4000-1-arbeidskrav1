theme(axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank()) +
labs(title = "A t-distribution") +
coord_flip()
distribution
bland_altman <- data %>%
select(fp:pt.60) %>%
filter(leg == "R") %>%
pivot_longer(cols = pt.60,
names_to = c("variable","speed"),
values_to = "value",
names_sep = "[.]") %>%
pivot_wider(names_from = timepoint,
values_from = value) %>%
rowwise () %>%
mutate(diff = post - pre,
avg = mean(c(pre, post))) %>%
ggplot(aes(avg, diff)) +
geom_point() +
scale_y_continuous(limits = c(-1000, 1000)) +
geom_hline(yintercept = sum_stat$mdiff) +
geom_hline(yintercept = sum_stat$mdiff + sum_stat$L) +
geom_hline(yintercept = sum_stat$mdiff - sum_stat$L)  +
labs(x = "Average of both measures",
y = "Difference between measurements",
title = "Bland-Altman plot")
bland_altman
bland_altman <- data %>%
select(fp:pt.60) %>%
filter(leg == "R") %>%
pivot_longer(cols = pt.60,
names_to = c("variable","speed"),
values_to = "value",
names_sep = "[.]") %>%
pivot_wider(names_from = timepoint,
values_from = value) %>%
rowwise () %>%
mutate(diff = post - pre,
avg = mean(c(pre, post))) %>%
ggplot(aes(avg, diff)) +
geom_point() +
scale_y_continuous(limits = c(-25, 45)) +
geom_hline(yintercept = sum_stat$mdiff) +
geom_hline(yintercept = sum_stat$mdiff + sum_stat$L) +
geom_hline(yintercept = sum_stat$mdiff - sum_stat$L)  +
labs(x = "Average of both measures",
y = "Difference between measurements",
title = "Bland-Altman plot")
bland_altman
plot_grid(bland_altman, distribution, align = "h", nrow = 1, rel_widths = c(1, 0.3))
library(blandr)
library(cowplot)
plot_grid(bland_altman, distribution, align = "h", nrow = 1, rel_widths = c(1, 0.3))
data %>% print()
data %>%
pivot_longer(names_to = "Test",
values_to = "values",
cols = pt.60:ttp.iso) %>% print()
data %>%
pivot_longer(names_to = "Test",
values_to = "values",
cols = pt.60:ttp.iso) %>%
pivot_wider(names_from = timepoint,
values_from = values) %>%
group_by(Test) %>%
summarise(mean = mean(pre, na.rm = T)) %>% print()
data %>%
pivot_longer(names_to = "Test",
values_to = "values",
cols = pt.60:ttp.iso) %>%
pivot_wider(names_from = timepoint,
values_from = values) %>%
group_by(Test) %>%
summarise(mean = mean(pre, na.rm = T)) %>%
ungroup() %>%
separate(Test, into = c("test", "speed")) %>% print()
data %>%
pivot_longer(names_to = "Test",
values_to = "values",
cols = pt.60:ttp.iso) %>%
pivot_wider(names_from = timepoint,
values_from = values) %>%
group_by(Test) %>%
summarise(mean = mean(pre, na.rm = T)) %>%
ungroup() %>%
separate(Test, into = c("test", "speed")) %>%
select(-test) %>% print()
data %>%
pivot_longer(names_to = "Test",
values_to = "values",
cols = pt.60:pt.iso) %>%
pivot_wider(names_from = timepoint,
values_from = values) %>%
group_by(Test) %>%
summarise(mean = mean(pre, na.rm = T)) %>%
ungroup() %>%
separate(Test, into = c("test", "speed")) %>%
select(-test) %>% print()
View(data)
data %>%
pivot_longer(names_to = "Test",
values_to = "values",
cols = c(pt.60, pt.120, pt.240,
pt.360, pt.480, pt.iso)) %>%
pivot_wider(names_from = timepoint,
values_from = values) %>%
group_by(Test) %>%
summarise(mean = mean(pre, na.rm = T)) %>%
ungroup() %>%
separate(Test, into = c("test", "speed")) %>%
select(-test) %>% print()
data %>%
pivot_longer(names_to = "Test",
values_to = "values",
cols = c(pt.60, pt.120, pt.240,
pt.360, pt.480, pt.iso)) %>%
pivot_wider(names_from = timepoint,
values_from = values) %>%
group_by(Test) %>%
summarise(mean = mean(pre, na.rm = T)) %>%
ungroup() %>%
separate(Test, into = c("test", "speed")) %>%
select(-test) %>%
mutate(speed = factor(speed, levels = c("60", "120", "240", "360", "480", "iso"))) %>% print()
data %>%
pivot_longer(names_to = "Test",
values_to = "values",
cols = c(pt.60, pt.120, pt.240,
pt.360, pt.480, pt.iso)) %>%
pivot_wider(names_from = timepoint,
values_from = values) %>%
group_by(Test) %>%
summarise(mean = mean(pre, na.rm = T)) %>%
ungroup() %>%
separate(Test, into = c("test", "speed")) %>%
select(-test) %>%
mutate(speed = factor(speed, levels = c("iso", "60", "120", "240", "360", "480"))) %>% print()
data %>%
pivot_longer(names_to = "Test",
values_to = "values",
cols = c(pt.60, pt.120, pt.240,
pt.360, pt.480, pt.iso)) %>%
pivot_wider(names_from = timepoint,
values_from = values) %>%
group_by(Test) %>%
summarise(mean = mean(pre, na.rm = T)) %>%
ungroup() %>%
separate(Test, into = c("test", "speed")) %>%
select(-test) %>%
mutate(speed = factor(speed, levels = c("iso", "60", "120", "240", "360", "480"))) %>%
ggplot(aes(speed, mean)) +
geom_point()
data %>%
pivot_longer(names_to = "Test",
values_to = "values",
cols = c(pt.60, pt.120, pt.240,
pt.360, pt.480, pt.iso)) %>%
pivot_wider(names_from = timepoint,
values_from = values) %>%
group_by(Test) %>%
summarise(mean = mean(pre, na.rm = T),
s = sd(pre, na.rm = T)) %>%
ungroup() %>%
separate(Test, into = c("test", "speed")) %>%
select(-test) %>%
mutate(speed = factor(speed, levels = c("iso", "60", "120", "240", "360", "480"))) %>%
ggplot(aes(speed, mean)) +
geom_point()
data %>%
pivot_longer(names_to = "Test",
values_to = "values",
cols = c(pt.60, pt.120, pt.240,
pt.360, pt.480, pt.iso)) %>%
pivot_wider(names_from = timepoint,
values_from = values) %>%
group_by(Test) %>%
summarise(mean = mean(pre, na.rm = T),
s = sd(pre, na.rm = T)) %>%
ungroup() %>%
separate(Test, into = c("test", "speed")) %>%
select(-test) %>%
mutate(speed = factor(speed, levels = c("iso", "60", "120", "240", "360", "480"))) %>%
ggplot(aes(speed, mean)) +
geom_point() +
geom_line() +
theme_bw()
data %>%
pivot_longer(names_to = "Test",
values_to = "values",
cols = c(pt.60, pt.120, pt.240,
pt.360, pt.480, pt.iso)) %>%
pivot_wider(names_from = timepoint,
values_from = values) %>%
group_by(Test) %>%
summarise(mean = mean(pre, na.rm = T),
s = sd(pre, na.rm = T)) %>%
ungroup() %>%
separate(Test, into = c("test", "speed")) %>%
select(-test) %>%
mutate(speed = factor(speed, levels = c("iso", "60", "120", "240", "360", "480"))) %>%
ggplot(aes(speed, mean)) +
geom_point() +
geom_line() +
theme_classic()
data %>%
pivot_longer(names_to = "Test",
values_to = "values",
cols = c(pt.60, pt.120, pt.240,
pt.360, pt.480, pt.iso)) %>%
pivot_wider(names_from = timepoint,
values_from = values) %>%
group_by(Test) %>%
summarise(mean = mean(pre, na.rm = T),
s = sd(pre, na.rm = T)) %>%
ungroup() %>%
separate(Test, into = c("test", "speed")) %>%
select(-test) %>%
mutate(speed = factor(speed, levels = c("iso", "60", "120", "240", "360", "480")), labels = c("0", "60", "120", "240", "360", "480")) %>%
ggplot(aes(speed, mean)) +
geom_point() +
geom_line() +
theme_classic()
data %>%
pivot_longer(names_to = "Test",
values_to = "values",
cols = c(pt.60, pt.120, pt.240,
pt.360, pt.480, pt.iso)) %>%
pivot_wider(names_from = timepoint,
values_from = values) %>%
group_by(Test) %>%
summarise(mean = mean(pre, na.rm = T),
s = sd(pre, na.rm = T)) %>%
ungroup() %>%
separate(Test, into = c("test", "speed")) %>%
select(-test) %>%
mutate(speed = factor(speed, levels = c("iso", "60", "120", "240", "360", "480"), labels = c("0", "60", "120", "240", "360", "480"))) %>%
ggplot(aes(speed, mean)) +
geom_point() +
geom_line() +
theme_classic()
data %>%
pivot_longer(names_to = "Test",
values_to = "values",
cols = c(pt.60, pt.120, pt.240,
pt.360, pt.480, pt.iso)) %>%
pivot_wider(names_from = timepoint,
values_from = values) %>%
group_by(Test) %>%
summarise(mean = mean(pre, na.rm = T),
s = sd(pre, na.rm = T)) %>%
ungroup() %>%
separate(Test, into = c("test", "speed")) %>%
select(-test) %>%
mutate(speed = factor(speed, levels = c("iso", "60", "120", "240", "360", "480"), labels = c("0", "60", "120", "240", "360", "480"))) %>%
ggplot(aes(speed, mean)) +
geom_point() +
geom_line() +
geom_errorbar(aes(ymin = mean - s, ymax = mean + s)) +
theme_classic()
data %>%
pivot_longer(names_to = "Test",
values_to = "values",
cols = c(pt.60, pt.120, pt.240,
pt.360, pt.480, pt.iso)) %>%
pivot_wider(names_from = timepoint,
values_from = values) %>%
group_by(Test) %>%
summarise(mean = mean(pre, na.rm = T),
s = sd(pre, na.rm = T)) %>%
ungroup() %>%
separate(Test, into = c("test", "speed")) %>%
select(-test) %>%
mutate(speed = factor(speed, levels = c("iso", "60", "120", "240", "360", "480"), labels = c("0", "60", "120", "240", "360", "480"))) %>%
ggplot(aes(speed, mean)) +
geom_point() +
geom_line() +
geom_errorbar(aes(ymin = mean - s, ymax = mean + s), width = 0.2) +
theme_classic()
data %>%
pivot_longer(names_to = "Test",
values_to = "values",
cols = c(pt.60, pt.120, pt.240,
pt.360, pt.480, pt.iso)) %>%
pivot_wider(names_from = timepoint,
values_from = values) %>%
group_by(Test) %>%
summarise(mean = mean(pre, na.rm = T),
s = sd(pre, na.rm = T)) %>%
ungroup() %>%
separate(Test, into = c("test", "speed")) %>%
select(-test) %>%
mutate(speed = factor(speed, levels = c("iso", "60", "120", "240", "360", "480"), labels = c("0", "60", "120", "240", "360", "480"))) %>%
ggplot(aes(speed, mean)) +
geom_point(size = 4) +
geom_line() +
geom_errorbar(aes(ymin = mean - s, ymax = mean + s), width = 0.2) +
theme_classic()
data %>%
pivot_longer(names_to = "Test",
values_to = "values",
cols = c(pt.60, pt.120, pt.240,
pt.360, pt.480, pt.iso)) %>%
pivot_wider(names_from = timepoint,
values_from = values) %>%
group_by(Test) %>%
summarise(mean = mean(pre, na.rm = T),
s = sd(pre, na.rm = T)) %>%
ungroup() %>%
separate(Test, into = c("test", "speed")) %>%
select(-test) %>%
mutate(speed = factor(speed, levels = c("iso", "60", "120", "240", "360", "480"), labels = c("0", "60", "120", "240", "360", "480"))) %>%
ggplot(aes(speed, mean)) +
geom_point(size = 3,
shape = 21) +
geom_line() +
geom_errorbar(aes(ymin = mean - s, ymax = mean + s), width = 0.2) +
theme_classic()
data %>%
pivot_longer(names_to = "Test",
values_to = "values",
cols = c(pt.60, pt.120, pt.240,
pt.360, pt.480, pt.iso)) %>%
pivot_wider(names_from = timepoint,
values_from = values) %>%
group_by(Test) %>%
summarise(mean = mean(pre, na.rm = T),
s = sd(pre, na.rm = T)) %>%
ungroup() %>%
separate(Test, into = c("test", "speed")) %>%
select(-test) %>%
mutate(speed = factor(speed, levels = c("iso", "60", "120", "240", "360", "480"), labels = c("0", "60", "120", "240", "360", "480"))) %>%
ggplot(aes(speed, mean)) +
geom_point(size = 2.5) +
geom_line() +
geom_errorbar(aes(ymin = mean - s, ymax = mean + s), width = 0.2) +
theme_classic()
data %>%
pivot_longer(names_to = "Test",
values_to = "values",
cols = c(pt.60, pt.120, pt.240,
pt.360, pt.480, pt.iso)) %>%
pivot_wider(names_from = timepoint,
values_from = values) %>%
group_by(Test) %>%
summarise(mean = mean(pre, na.rm = T),
s = sd(pre, na.rm = T)) %>%
ungroup() %>%
separate(Test, into = c("test", "speed")) %>%
select(-test) %>%
mutate(speed = factor(speed, levels = c("iso", "60", "120", "240", "360", "480"), labels = c("0", "60", "120", "240", "360", "480"))) %>%
ggplot(aes(speed, mean)) +
geom_point(size = 3) +
geom_line() +
geom_errorbar(aes(ymin = mean - s, ymax = mean + s), width = 0.2) +
theme_classic()
data %>%
pivot_longer(names_to = "Test",
values_to = "values",
cols = c(pt.60, pt.120, pt.240,
pt.360, pt.480, pt.iso)) %>%
pivot_wider(names_from = timepoint,
values_from = values) %>%
group_by(Test) %>%
summarise(mean = mean(pre, na.rm = T),
s = sd(pre, na.rm = T)) %>%
ungroup() %>%
separate(Test, into = c("test", "speed")) %>%
select(-test) %>%
mutate(speed = factor(speed, levels = c("iso", "60", "120", "240", "360", "480"), labels = c("0", "60", "120", "240", "360", "480"))) %>%
ggplot(aes(speed, mean)) +
geom_point(size = 3) +
geom_errorbar(aes(ymin = mean - s, ymax = mean + s), width = 0.2) +
theme_bw() +
theme()
data %>%
pivot_longer(names_to = "Test",
values_to = "values",
cols = c(pt.60, pt.120, pt.240,
pt.360, pt.480, pt.iso)) %>%
pivot_wider(names_from = timepoint,
values_from = values) %>%
group_by(Test) %>%
summarise(mean = mean(pre, na.rm = T),
s = sd(pre, na.rm = T)) %>%
ungroup() %>%
separate(Test, into = c("test", "speed")) %>%
select(-test) %>%
mutate(speed = factor(speed, levels = c("iso", "60", "120", "240", "360", "480"), labels = c("0", "60", "120", "240", "360", "480"))) %>%
ggplot(aes(speed, mean)) +
geom_point(size = 3) +
geom_errorbar(aes(ymin = mean - s, ymax = mean + s), width = 0.2) +
theme_bw() +
labs(x = "Speed (deg/s)",
y = "Peak Torque")
data %>%
pivot_longer(names_to = "Test",
values_to = "values",
cols = c(pt.60, pt.120, pt.240,
pt.360, pt.480, pt.iso)) %>%
pivot_wider(names_from = timepoint,
values_from = values) %>%
group_by(Test) %>%
summarise(mean = mean(pre, na.rm = T),
s = sd(pre, na.rm = T)) %>%
ungroup() %>%
separate(Test, into = c("test", "speed")) %>%
select(-test) %>%
mutate(speed = factor(speed, levels = c("iso", "60", "120", "240", "360", "480"), labels = c("0", "60", "120", "240", "360", "480"))) %>%
ggplot(aes(speed, mean)) +
geom_point(size = 3) +
geom_errorbar(aes(ymin = mean - s, ymax = mean + s), width = 0.2) +
theme_bw() +
labs(x = "Speed (deg/s)",
y = "Peak Torque") +
theme(panel.grid.minor = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank())
data %>%
pivot_longer(names_to = "Test",
values_to = "values",
cols = c(pt.60, pt.120, pt.240,
pt.360, pt.480, pt.iso)) %>%
pivot_wider(names_from = timepoint,
values_from = values) %>%
group_by(Test) %>%
summarise(mean = mean(pre, na.rm = T),
s = sd(pre, na.rm = T)) %>%
ungroup() %>%
separate(Test, into = c("test", "speed")) %>%
select(-test) %>%
mutate(speed = factor(speed, levels = c("iso", "60", "120", "240", "360", "480"), labels = c("0", "60", "120", "240", "360", "480"))) %>%
ggplot(aes(speed, mean)) +
geom_point(size = 3) +
geom_errorbar(aes(ymin = mean - s, ymax = mean + s), width = 0.2) +
theme_bw() +
labs(x = "Speed (deg/s)",
y = "Peak Torque") +
theme(panel.grid.minor = element_blank(),
panel.grid.minor.y = element_blank())
data %>%
pivot_longer(names_to = "Test",
values_to = "values",
cols = c(pt.60, pt.120, pt.240,
pt.360, pt.480, pt.iso)) %>%
pivot_wider(names_from = timepoint,
values_from = values) %>%
group_by(Test) %>%
summarise(mean = mean(pre, na.rm = T),
s = sd(pre, na.rm = T)) %>%
ungroup() %>%
separate(Test, into = c("test", "speed")) %>%
select(-test) %>%
mutate(speed = factor(speed, levels = c("iso", "60", "120", "240", "360", "480"), labels = c("0", "60", "120", "240", "360", "480"))) %>%
ggplot(aes(speed, mean)) +
geom_point(size = 3) +
geom_errorbar(aes(ymin = mean - s, ymax = mean + s), width = 0.2) +
scale_y_continuous(breaks = seq(0, 350, 50)) +
theme_bw() +
labs(x = "Speed (deg/s)",
y = "Peak Torque") +
theme(panel.grid.minor = element_blank(),
panel.grid.minor.y = element_blank())
data %>%
pivot_longer(cols = pt.60:ttp.iso,
names_to = c("variable","speed"),
values_to = "value",
names_sep = "[.]") %>% # transform the dataset into long format
pivot_wider(names_from = timepoint,
values_from = value) %>% # transform the dataset back to wide format for easy calculations of differences from pre to post
mutate(diff = post - pre) %>% # make a new column named "diff" with differences scores
group_by(variable, speed) %>% # make a grouped dataset based on leg, variable and speed
summarise(m = mean(c(pre, post), na.rm = T), # calculate the average score from both pre and post testing
sd = sd(diff, na.rm = T), # calculate the standard divination of the diff scores
te = sd / sqrt(2), # calculate the typical error of the diff scores
cv = 100 * (te / m), # calculate the relative typical error (coefficient of variation)
L = qt(0.975, 4) * sd) %>%  # calculate the limits of agreement for diff scores
ungroup() %>% # ungroup the dataset
select(-sd) %>%
pivot_wider(names_from = variable,
values_from = m:L) %>%
select(speed, m_pt, te_pt, cv_pt, L_pt,
m_ttp, te_ttp, cv_ttp, L_ttp) %>%
mutate(speed = factor(speed, levels = c("60",
"120",
"240",
"360",
"480",
"iso"),
labels = c("60 (deg/s)",
"120 (deg/s)",
"240 (deg/s)",
"360 (deg/s)",
"480 (deg/s)",
"Isometric (60 deg)"))) %>%
arrange(speed) %>%
gt() %>%
tab_spanner(columns = m_pt:L_pt, label = md("Peak Torque<br> (N/m)")) %>%
tab_spanner(columns = m_ttp:L_ttp, label = md("Time To Peak Torque<br> (seconds)")) %>%
fmt_number(columns = m_pt:L_pt, decimals = 1) %>%
fmt_number(columns = m_ttp:L_ttp, decimals = 2) %>%
cols_label(speed = "Protocol",
m_pt = "M",
te_pt = "TE",
cv_pt = "CV",
L_pt = "LoA",
m_ttp = "M",
te_ttp = "TE",
cv_ttp = "CV",
L_ttp = "LoA") %>%
tab_footnote(footnote = "Abbriviations: M, mean; TE, typical error; CV, coefficient of variations; LoA, limits of agreement")
